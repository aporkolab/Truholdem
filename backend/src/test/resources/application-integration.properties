# ==============================================================================
# TruHoldem Integration Test Configuration
# ==============================================================================
# This configuration is for integration tests using real PostgreSQL and Redis
# instances via Testcontainers. Provides production-like testing environment.
#
# Profile: integration
# Usage: @ActiveProfiles("integration") with @Import(IntegrationTestConfig.class)
#
# REQUIREMENTS:
# - Docker must be running on the host machine
# - Sufficient memory for containers (~512MB recommended)
# ==============================================================================

# ==============================================================================
# DATABASE CONFIGURATION - Testcontainers PostgreSQL
# ==============================================================================
# Connection details are automatically configured by @ServiceConnection
# These are fallback values - IntegrationTestConfig.java sets actual values

spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Enable Liquibase for integration tests (optional - can use ddl-auto instead)
spring.liquibase.enabled=false

# ==============================================================================
# REDIS CONFIGURATION - Testcontainers Redis
# ==============================================================================
# Connection details are set by IntegrationTestConfig via system properties

spring.cache.type=redis
spring.data.redis.repositories.enabled=true

# ==============================================================================
# SECURITY CONFIGURATION - Same as unit tests
# ==============================================================================

app.jwt.secret=testSecretKeyForTesting_AtLeast32Chars_LongEnough_ForHS256!!
app.jwt.expiration=3600000
app.jwt.refresh-expiration=7200000
app.jwt.refreshExpiration=7200000

# ==============================================================================
# GAME CONFIGURATION
# ==============================================================================

app.game.default-chips=1000
app.game.default-small-blind=10
app.game.default-big-blind=20
app.game.max-players=10
app.game.min-players=2
app.game.bot-think-time=100
app.game.botThinkTime=100

# ==============================================================================
# CORS & WEBSOCKET - Permissive for Integration Tests
# ==============================================================================

app.cors.allowed-origins=http://localhost:4200
app.cors.allowedOrigins=*
app.cors.allowedMethods=GET,POST,PUT,DELETE,PATCH,OPTIONS
app.cors.allowedHeaders=*

# WebSocket enabled for integration tests (mocked in IntegrationTestConfig)
app.websocket.enabled=true
app.websocket.allowedOrigins=*

# ==============================================================================
# RATE LIMITING - Disabled
# ==============================================================================

rate-limit.enabled=false

# ==============================================================================
# LOGGING - More verbose for debugging integration issues
# ==============================================================================

logging.level.root=WARN
logging.level.com.truholdem=DEBUG
logging.level.org.springframework=WARN
logging.level.org.springframework.transaction=DEBUG
logging.level.org.hibernate=WARN
logging.level.org.hibernate.SQL=DEBUG

# Testcontainers logging - useful for container startup issues
logging.level.org.testcontainers=INFO
logging.level.com.github.dockerjava=WARN
logging.level.tc=INFO

# ==============================================================================
# ACTUATOR - Enabled for health checks
# ==============================================================================

management.endpoints.enabled-by-default=true
management.endpoint.health.enabled=true
management.endpoint.health.show-details=always

# ==============================================================================
# SERVER CONFIGURATION
# ==============================================================================

server.port=0

# ==============================================================================
# TESTCONTAINERS CONFIGURATION
# ==============================================================================

# Enable reuse of containers for faster local development
testcontainers.reuse.enable=true

# Disable Ryuk (container cleanup) - useful for debugging but enable in CI
# testcontainers.ryuk.disabled=true
